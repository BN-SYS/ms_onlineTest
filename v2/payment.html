<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²°ì œ ì„ íƒ - ë©˜ì‚¬ ì˜¨ë¼ì¸ í…ŒìŠ¤íŠ¸</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/payment.css">
</head>

<body>
    <!-- í—¤ë” -->
    <div id="header-placeholder"></div>
    <div class="payment-container">
        <div class="payment-header">
            <h1>ğŸ‰ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!</h1>
            <p>ê²°ê³¼ë¥¼ í™•ì¸í•˜ì‹œë ¤ë©´ ê²°ì œ ì˜µì…˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”</p>
        </div>

        <div class="payment-options">
            <!-- ê¸°ë³¸ ê²°ê³¼ -->
            <div class="payment-card" onclick="selectPayment('basic')">
                <h3>ğŸ“Š ê¸°ë³¸ ê²°ê³¼</h3>
                <div class="price">
                    19,900<small>ì›</small>
                </div>
                <ul>
                    <li>IQ ì¶”ì • ì ìˆ˜</li>
                    <li>ë°±ë¶„ìœ„ ìˆœìœ„</li>
                    <li>3ê°€ì§€ ì˜ì—­ë³„ ì ìˆ˜</li>
                    <li>ì´ë©”ì¼ ê²°ê³¼ ë°œì†¡</li>
                </ul>
                <button class="payment-btn" onclick="event.stopPropagation(); processPayment('basic')">
                    ê¸°ë³¸ ê²°ê³¼ ê²°ì œí•˜ê¸°
                </button>
            </div>

            <!-- ìƒì„¸ ë¦¬í¬íŠ¸ -->
            <div class="payment-card" onclick="selectPayment('detail')">
                <div class="badge">ì¶”ì²œ</div>
                <h3>ğŸ“ˆ ìƒì„¸ ë¦¬í¬íŠ¸</h3>
                <div class="price">
                    24,900<small>ì›</small>
                </div>
                <ul>
                    <li><strong>ê¸°ë³¸ ê²°ê³¼ ì „ì²´ í¬í•¨</strong></li>
                    <li>ì˜ì—­ë³„ ìƒì„¸ í•´ì„</li>
                    <li>í‘œì¤€í¸ì°¨ ê·¸ë˜í”„</li>
                    <li>PDF ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥</li>
                </ul>
                <button class="payment-btn" onclick="event.stopPropagation(); processPayment('detail')">
                    ìƒì„¸ ë¦¬í¬íŠ¸ ê²°ì œí•˜ê¸°
                </button>
            </div>
        </div>

        <div class="upgrade-notice">
            <strong>ğŸ’¡ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤</strong>
            <p>ê¸°ë³¸ ê²°ê³¼ë¥¼ ë¨¼ì € í™•ì¸í•˜ì‹  í›„, ì°¨ì•¡(5,000ì›)ì„ ê²°ì œí•˜ì‹œë©´ ìƒì„¸ ë¦¬í¬íŠ¸ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
    </div>

    <!-- í‘¸í„° -->
    <div id="footer-placeholder"></div>

    <!-- include.js ì¶”ê°€ -->
    <script src="js/include.js"></script>
    <script>
        function selectPayment(type) {
            document.querySelectorAll('.payment-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function processPayment(type) {
            const userData = JSON.parse(localStorage.getItem('userData'));
            const stage1 = JSON.parse(localStorage.getItem('stage1Result'));
            const stage2 = JSON.parse(localStorage.getItem('stage2Result'));
            const stage3 = JSON.parse(localStorage.getItem('stage3Result'));

            if (!userData || !stage1 || !stage2 || !stage3) {
                alert('í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                location.href = 'index.html';
                return;
            }

            // ì‹¤ì œë¡œëŠ” ì´ë‹ˆì‹œìŠ¤ PG ì—°ë™
            if (confirm(`${type === 'basic' ? '19,900' : '24,900'}ì›ì„ ê²°ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                // ê²°ì œ ì„±ê³µ ì‹œë®¬ë ˆì´ì…˜
                setTimeout(() => {
                    // ê²°ì œ ì •ë³´ ì €ì¥
                    const paymentInfo = {
                        type: type,
                        amount: type === 'basic' ? 9900 : 19900,
                        timestamp: new Date().toISOString(),
                        transactionId: 'TXN' + Date.now(),
                        certificateNumber: generateCertificateNumber(),
                        verificationCode: generateVerificationCode()
                    };

                    localStorage.setItem('paymentInfo', JSON.stringify(paymentInfo));

                    alert('ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');

                    // ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
                    if (type === 'basic') {
                        location.href = 'result-basic.html';
                    } else {
                        location.href = 'result-detail.html';
                    }
                }, 1000);
            }
        }

        // ê³ ìœ  ë°œê¸‰ë²ˆí˜¸ ìƒì„±
        function generateCertificateNumber() {
            const year = new Date().getFullYear();
            const random = Math.floor(Math.random() * 1000000).toString().padStart(6, '0');
            return `MENSA-${year}-${random}`;
        }

        // ì§„ìœ„ í™•ì¸ ì½”ë“œ ìƒì„±
        function generateVerificationCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 12; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
                if ((i + 1) % 4 === 0 && i < 11) code += '-';
            }
            return code;
        }
    </script>
</body>

</html>